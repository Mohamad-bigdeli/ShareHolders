
# این API برای دریافت لیست تاریخچه سهامداران یک شرکت بورسی خاص بر اساس نماد بورسی طراحی شده است. این API از صفحه‌بندی پشتیبانی می‌کند و نتایج آن برای بهبود عملکرد به مدت 15 دقیقه کش می‌شوند.

## اطلاعات کلی
- **مسیر (Endpoint):** `/api/shareholders/<str:symbol>/`
- **متد:** `GET`
- **فرمت پاسخ:** JSON
- **پشتیبانی از صفحه‌بندی:** دارد (با استفاده از کلاس `CustomPagination`)
- **کشینگ:** نتایج به مدت 15 دقیقه کش می‌شوند (`cache_page(60 * 15)`)

## پارامترهای ورودی
این API یک پارامتر مسیر (Path Parameter) دریافت می‌کند:

| پارامتر   | نوع    | توضیحات                           | اجباری؟ |
|-----------|--------|-----------------------------------|----------|
| `symbol`  | String | نماد بورسی شرکت (مثال: "فملی")  | بله      |

### توضیحات پارامتر
- **symbol**: نماد بورسی شرکت (مانند "فملی"، "شستا"، "خساپا") که برای فیلتر کردن تاریخچه سهامداران استفاده می‌شود.

## پاسخ API
پاسخ API به‌صورت JSON و شامل لیست تاریخچه سهامداران برای نماد مشخص‌شده است. در صورت استفاده از صفحه‌بندی، پاسخ شامل متادیتای صفحه‌بندی نیز خواهد بود.

### ساختار پاسخ (با صفحه‌بندی)
```json
{
  "count": 10,
  "next": "http://127.0.0.1:8000/shareholder/api/v1/shareholders/خودرو/?page=2",
  "previous": null,
  "results": [
    {
      "id": "12345",
      "shareholder_name": "شرکت سرمایه‌گذاری صبا تامین",
      "symbol": "فملی",
      "shareholder_shares": 1500000000,
      "shareholder_percentage": 5.25,
      "date": "2025-04-19",
      "change": 0.15,
      "created_at": "2025-04-19T10:00:00Z",
      "updated_at": "2025-04-19T12:00:00Z"
    },
    ...
  ]
}
```

### توضیحات فیلدهای پاسخ
- **id**: شناسه یکتای رکورد سهامدار.
- **shareholder_name**: نام سهامدار (مثال: "شرکت سرمایه‌گذاری صبا تامین").
- **symbol**: نماد بورسی شرکت (مثال: "فملی").
- **shareholder_shares**: تعداد سهام در اختیار سهامدار.
- **shareholder_percentage**: درصد مالکیت سهامدار.
- **date**: تاریخ گزارش.
- **change**: تغییر درصد مالکیت نسبت به گزارش قبلی.
- **created_at**: زمان ایجاد رکورد.
- **updated_at**: زمان آخرین به‌روزرسانی رکورد.

## خطاها
در صورت بروز خطا، پاسخ API شامل یک پیام خطا و کد وضعیت HTTP خواهد بود:

### خطای عدم ارائه نماد
```json
{
  "error": "پارامتر نماد اجباری است"
}
```
- **کد وضعیت:** `400 Bad Request`

### خطای عدم وجود داده
```json
{
  "error": "نماد وجود ندارد یا داده‌ای برای آن ثبت نشده است"
}
```
- **کد وضعیت:** `404 Not Found`

## مثال‌های استفاده
### 1. دریافت تاریخچه سهامداران برای نماد "فملی"
**درخواست:**
```bash
curl -X GET "http://127.0.0.1:8000/shareholder/api/v1/shareholders/فملی/"
```

**پاسخ:**
```json
{
  "count": 2,
  "next": null,
  "previous": null,
  "results": [
    {
      "id": "12345",
      "shareholder_name": "شرکت سرمایه‌گذاری صبا تامین",
      "symbol": "فملی",
      "shareholder_shares": 1500000000,
      "shareholder_percentage": 5.25,
      "date": "2025-04-19",
      "change": 0.15,
      "created_at": "2025-04-19T10:00:00Z",
      "updated_at": "2025-04-19T12:00:00Z"
    },
    {
      "id": "67890",
      "shareholder_name": "شرکت سرمایه‌گذاری ملی ایران",
      "symbol": "فملی",
      "shareholder_shares": 2000000000,
      "shareholder_percentage": 7.1,
      "date": "2025-04-19",
      "change": -0.2,
      "created_at": "2025-04-19T09:00:00Z",
      "updated_at": "2025-04-19T11:00:00Z"
    }
  ]
}
```

### 2. درخواست برای نماد ناموجود
**درخواست:**
```bash
curl -X GET "http://127.0.0.1:8000/shareholder/api/v1/shareholders/ناموجود/"
```

**پاسخ:**
```json
{
  "error": "نماد وجود ندارد یا داده‌ای برای آن ثبت نشده است"
}
```
_______________________________________________________
